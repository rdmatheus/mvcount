% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/1_berg.R
\name{berg}
\alias{berg}
\alias{dberg}
\alias{pberg}
\alias{qberg}
\alias{rberg}
\title{The Reparameterized BerG Distribution}
\usage{
dberg(x, mu, sigma2, log.p = FALSE, ...)

pberg(q, mu, sigma2, lower.tail = TRUE, log.p = FALSE, ...)

qberg(p, mu, sigma2, lower.tail = TRUE, ...)

rberg(n, mu, sigma2, ...)

berg(mu.link = "log", sigma2.link = "log")
}
\arguments{
\item{x}{vector of non-negative integer quantiles.}

\item{mu}{numeric; non-negative mean.}

\item{sigma2}{numeric; variance (greather than \code{abs(mu * (mu - 1))}),}

\item{log.p}{logical; if \code{TRUE}, probabilities \code{p} are given as \code{log(p)}.}

\item{...}{possible extra parameters, in addition to the mean and variance, in a distribution
added to the \code{rigpsreg} package. Not used in RIPO distribution.}

\item{q}{vector of quantiles.}

\item{lower.tail}{logical; if TRUE (default), probabilities are \code{P(X <= x)}, otherwise, \code{P(X > x)}.}

\item{p}{vector of probabilities.}

\item{n}{number of random values to return.}

\item{mu.link, sigma2.link}{defines the link functions for the mean and variance regression models,
respectively, in the \code{\link{mvreg}} function, with \code{"log"} link as the default.
Other links are \code{"identity"} and \code{"sqrt"}.}
}
\value{
\code{dberg} returns the probability mass function, \code{pberg} gives the distribution
    function, \code{qberg} gives the quantile function, and \code{rberg} generates random
    observations.

    \code{berg} returns a \code{"count"} object mainly used to fit the BerG distribution
        via \code{\link{mvreg}} function. It returns a list with the following components:
        \describe{
          \item{abb}{abbreviation of the distribution in the \code{mvcount} package.}
          \item{name}{capitalized name of the distribution.}
          \item{npar}{number of parameters of the distribution.}
          \item{mu.link, sigma2.link}{specified link functions for the mean (\code{mu}) and the
              variance (\code{sigma2}) parameters, respectively.}
          \item{constraint}{a function \code{function(mu, sigma2)} that returns \code{TRUE} if
              the values of \code{mu} and \code{sigma} satisfy the constraint between the mean
              and variance of the distribution.}
          \item{start}{a function \code{function(x, X, Z)} which provides initial values for the
              regression coefficients of a double regression fit of the distribution.}
          \item{has_dl}{logical; if \code{TRUE}, it informs that the model has first and second
              order derivatives implemented; otherwise, they are obtained numerically via \code{\link{optim}}.}
          \item{dl.dmu,dl.dsigma}{functions \code{f(x, mu, sigma)} that provide the partial
              derivatives of the regression coefficients associated with the mean and variance,
              respectively. Its use is optional in the mvcount package. If they are not
              implemented, they must return \code{NULL}.}
         \item{dl2.dmu2, dl2,dsigma2, dl2.dmudsigma}{functions \code{f(x, mu, sigma)} that provide
              the second order partial derivatives of the regression coefficients associated with
              the mean and variance. Its use is optional in the mvcount package. If they are not
              implemented, they must return \code{NULL}.}
        }
}
\description{
Probability mass function, distribution function, quantile function, and random generation
for the reparameterized BerG distribution with mean \code{mu} and
variance \code{sigma2}.
}
\details{
This set of functions represents the probability mass function, the cumulative
   distribution function, quantile function, and a random number generator for the BerG
   distribution parameterized in terms of the mean (\code{mu}) and the variance (\code{sigma2}).
   This distribution was introduced by Bourguignon and Medeiros (2022) and
   also applied (in its reparametrized version) by Kokonendji, Medeiros, and Bourguignon (2024).
}
\examples{
n <- 10000

mu <- 2
sigma2 <- 3

y <- rberg(n, mu, sigma2)

# mean and variance theoretical vs empirical comparison
cat("\n mu:", mu, "--- sample mean:", round(mean(y), 3),
    "\n sigma2:", sigma2, "--- sample variance:", round(var(y), 3), "\n")

# probability mass function theoretical vs empirical comparison
yvals <- sort(unique(y))
xcoords <- barplot(prop.table(table(y)), xlab = "y", ylab = "Pmf", col = "white")
points(xcoords, dberg(yvals, mu, sigma2), pch = 16, col = 2, type = "b")

# distribution function theoretical vs empirical comparison
plot(ecdf(y), xlab = "y", ylab = "Cdf", main = " ")
curve(pberg(x, mu, sigma2), add = TRUE, col = 2, lwd = 2)

# quantile function theoretical vs empirical comparison
plot(seq(0.01, 0.99, 0.001), quantile(y, seq(0.01, 0.99, 0.001)),
     pch = 16, xlab = "p", ylab = "Quantile")
curve(qberg(x, mu, sigma2), add = TRUE, col = 2, lwd = 2)
}
\references{
Bourguignon, M., and de Medeiros, R. M. (2022). A simple and useful regression model
    for fitting count data. \emph{TEST}, \bold{31}, 790-827.

Kokonendji, C. C., Medeiros, R. M. R., and Bourguignon, M. (2024). Mean and variance
    count regression models based on reparameterized distributions. Submitted.
}
\author{
Rodrigo M. R. de Medeiros <\email{rodrigo.matheus@live.com}>
}
